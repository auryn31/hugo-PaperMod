<!DOCTYPE html>
<html lang="{{ .Site.Language }}" dir="{{ .Language.LanguageDirection | default " auto" }}">

<head>
  {{- partial "head.html" . }}
</head>

<body class="
{{- if (or (ne .Kind `page` ) (eq .Layout `archives`) (eq .Layout `search`)) -}}
{{- print " list" -}}
{{- end -}}
{{- if eq $.Site.Params.defaultTheme `dark` -}}
{{- print " dark" }}
{{- end -}} " id=" top">
  {{- partialCached "header.html" . .Page -}}
  <main class="main">
    {{- block "main" . }}{{ end }}
  </main>
  {{ partialCached "footer.html" . .Layout .Kind -}}
  <div class="cookie-container">
    <p>
      I use cookies on this website to give you the best experience on my blog. To find out more, read our
      <a href="{{ .Site.Params.Cookies }}">privacy policy and cookie policy</a>.
    </p>
    <button class="cookie-btn">
      Okay
    </button>
    <button class="nope-cookie-btn">
      Nope!
    </button>
  </div>
  <script>
    const cookieContainer = document.querySelector(".cookie-container");
    const cookieButton = document.querySelector(".cookie-btn");
    const nopeCookieButton = document.querySelector(".nope-cookie-btn");
    const cookieBannerDisplayed = "cookieBannerDisplayed"
    const analyticsIsAllowed = "analyticsIsAllowed"
    const analyics = () => {
      (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
          (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
          m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
      })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
      ga('create', 'G-Q2W252LSJR', 'auto');
      ga('send', 'pageview');
    }
    if (localStorage.getItem(analyticsIsAllowed) === "true") {
      analyics();
    }

    cookieButton.addEventListener("click", () => {
      cookieContainer.classList.remove("active");
      localStorage.setItem(cookieBannerDisplayed, "true");
      localStorage.setItem(analyticsIsAllowed, "true");
      analyics();
    });

    nopeCookieButton.addEventListener("click", () => {
      cookieContainer.classList.remove("active");
      localStorage.setItem(cookieBannerDisplayed, "true");
      localStorage.setItem(analyticsIsAllowed, "false");
    });

    setTimeout(() => {
      if (!localStorage.getItem(cookieBannerDisplayed)) {
        cookieContainer.classList.add("active");
      }
    }, 100);
  </script>
</body>

</html>